/* Design tokens */
:root{
  --bg-canvas:#F3F4F6;
  --bg:#FFFFFF;
  --text:#111827;
  --muted:#6B7280;
  --card:#FFFFFF;
  --border:#E5E7EB;
  --brand:#2563EB;
  --brand-50:#EEF2FF;
  --brand-100:#DBE7FE;
  --brand-700:#1D4ED8;
  --card-hover:#F7F7F7;
  --shadow-sm:0 1px 3px rgba(15,23,42,0.06);
  --shadow-md:0 18px 40px rgba(15,23,42,0.12);
  --fs-sm:14px;
  --fs-md:16px;
  --fs-lg:18px;
  --fs-xl:28px;
  --radius-sm:12px;
  --radius-md:16px;
  --radius-lg:20px;
  --gutter:16px;
  --space-2:8px;
  --space-3:12px;
  --space-4:16px;
  --space-6:24px;
  --transition-fast:160ms ease;
}

.dark{
  --bg-canvas:#05080C;
  --bg:#0B0F14;
  --text:#F3F4F6;
  --muted:#9CA3AF;
  --card:#0F141A;
  --border:#1F2937;
  --brand:#3B82F6;
  --brand-50:rgba(59,130,246,0.16);
  --brand-100:rgba(59,130,246,0.24);
  --brand-700:#C7D9FF;
  --card-hover:rgba(255,255,255,0.06);
  --shadow-sm:0 1px 4px rgba(0,0,0,0.55);
  --shadow-md:0 18px 40px rgba(0,0,0,0.55);
}

*{box-sizing:border-box;margin:0;padding:0}
html,body,#app{height:100%}
body{
  font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  font-size:var(--fs-md);
  background:var(--bg-canvas);
  color:var(--text);
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  display:flex;
  align-items:flex-start;
  justify-content:center;
  padding:var(--space-4) var(--gutter);
  -webkit-user-select:none;
  user-select:none;
  min-height:100vh;
  min-height:100dvh;
}

input,
textarea,
select,
[contenteditable="true"],
.allow-text-selection{
  -webkit-user-select:text;
  user-select:text;
}

html.scroll-lock,
body.scroll-lock{overflow:hidden}

/* Accessible helpers */
.sr-only{
  position:absolute;
  width:1px;
  height:1px;
  padding:0;
  margin:-1px;
  overflow:hidden;
  clip:rect(0,0,0,0);
  white-space:nowrap;
  border:0;
}

/* App shell */
.frame{
  width:100%;
  max-width:420px;
  background:var(--bg);
  border-radius:var(--radius-md);
  box-shadow:var(--shadow-md);
  overflow:hidden;
  min-height:auto;
  display:flex;
  flex-direction:column;
  position:relative;
  color:var(--text);
}

header.appbar{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:var(--space-2);
  padding:var(--space-4) var(--gutter);
  border-bottom:1px solid var(--border);
  background:var(--bg);
  position:sticky;
  top:0;
  z-index:70;
}

.appbar-left{display:flex;align-items:center;gap:var(--space-3);flex:1;min-width:0}
.app-title-group{display:flex;flex-direction:column;gap:4px;min-width:0}
.app-title{
  font-weight:700;
  font-size:var(--fs-xl);
  letter-spacing:-0.01em;
  line-height:1.1;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}
.app-subtitle{font-size:var(--fs-sm);color:var(--muted);line-height:1.3}
.appbar-right{position:relative;display:flex;align-items:center;justify-content:flex-end;gap:var(--space-2);min-width:44px}

.back-btn,
.icon-btn{
  appearance:none;
  border:none;
  background:transparent;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  width:44px;
  height:44px;
  border-radius:999px;
  cursor:pointer;
  color:var(--muted);
  font-size:22px;
  line-height:1;
  transition:background var(--transition-fast), transform var(--transition-fast), box-shadow var(--transition-fast);
  touch-action:manipulation;
}
.back-btn{font-size:28px;color:var(--text)}
.back-btn[hidden]{display:none}
.back-btn:hover,
.icon-btn:hover{background:var(--card-hover)}
.back-btn:focus-visible,
.icon-btn:focus-visible{outline:2px solid var(--brand);outline-offset:3px}
.icon-btn.soft{
  background:var(--brand-50);
  color:var(--brand-700);
  border:1px solid var(--brand-100);
  box-shadow:var(--shadow-sm);
}
.icon-btn.soft:hover{background:var(--brand-100)}

.app-menu{
  position:absolute;
  top:calc(100% + 8px);
  right:0;
  background:var(--card);
  border:1px solid var(--border);
  border-radius:var(--radius-sm);
  box-shadow:var(--shadow-md);
  padding:6px 0;
  min-width:200px;
  z-index:130;
}
.app-menu-item{
  width:100%;
  padding:12px var(--space-4);
  text-align:left;
  background:transparent;
  border:none;
  cursor:pointer;
  font-size:var(--fs-md);
  color:var(--text);
  transition:background var(--transition-fast);
}
.app-menu-item:hover{background:var(--card-hover)}
.app-menu-item:focus-visible{outline:none;background:var(--brand-50)}

/* screens */
.screen{display:none;padding:var(--space-4) var(--gutter) calc(80px + env(safe-area-inset-bottom));flex:1;overflow:auto;background:var(--bg)}
.screen.active{display:block}

/* main list of lists */
.lists{display:flex;flex-direction:column;gap:var(--space-3);margin-top:var(--space-3)}
.list-card{
  display:flex;
  align-items:center;
  gap:var(--space-3);
  padding:var(--space-4);
  border:1px solid var(--border);
  border-radius:var(--radius-sm);
  cursor:pointer;
  background:var(--card);
  box-shadow:var(--shadow-sm);
  min-height:64px;
  transition:transform var(--transition-fast), box-shadow var(--transition-fast), background var(--transition-fast);
  touch-action:pan-y;
}
.list-card:hover{background:var(--card-hover);box-shadow:0 10px 30px rgba(15,23,42,0.12)}
.list-card:active{transform:scale(0.98);box-shadow:var(--shadow-sm)}
.list-card:focus-visible{outline:2px solid var(--brand);outline-offset:4px}
.list-icon{
  width:40px;
  height:40px;
  border-radius:12px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:700;
  color:var(--brand-700);
  background:var(--brand-50);
  flex-shrink:0;
}
.list-icon svg{width:22px;height:22px}
.list-title{flex:1;font-weight:600;font-size:var(--fs-lg);line-height:1.35;color:var(--text)}
.list-counter{
  min-width:32px;
  height:28px;
  padding:0 10px;
  border-radius:999px;
  background:var(--brand-50);
  color:var(--brand-700);
  font-weight:600;
  font-size:var(--fs-sm);
  display:inline-flex;
  align-items:center;
  justify-content:center;
  box-shadow:var(--shadow-sm);
}

.centered-empty{
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:var(--space-3);
  text-align:center;
  padding:var(--space-6) 0;
  color:var(--muted);
}
.empty-illustration svg{width:96px;height:96px}
.empty-title{font-size:var(--fs-lg);font-weight:600;color:var(--text)}
.empty-description{font-size:var(--fs-sm);color:var(--muted);max-width:260px;line-height:1.45}
.empty-cta{
  padding:0 var(--space-6);
  height:44px;
  border-radius:999px;
  border:none;
  background:var(--brand);
  color:#fff;
  font-weight:600;
  font-size:var(--fs-md);
  cursor:pointer;
  box-shadow:var(--shadow-md);
  transition:transform var(--transition-fast), box-shadow var(--transition-fast);
  touch-action:manipulation;
}
.empty-cta:hover{transform:translateY(-1px);box-shadow:0 14px 36px rgba(37,99,235,0.28)}
.empty-cta:active{transform:scale(0.97)}
.empty-cta:focus-visible{outline:2px solid #fff;outline-offset:2px;box-shadow:0 0 0 3px var(--brand)}

/* Buttons */
.btn,
button.btn{
  padding:0 var(--space-4);
  height:44px;
  border-radius:var(--radius-sm);
  border:1px solid var(--border);
  background:var(--card);
  font-weight:600;
  color:var(--text);
  cursor:pointer;
  transition:background var(--transition-fast), transform var(--transition-fast);
  touch-action:manipulation;
}
button.primary{background:var(--brand);border-color:var(--brand);color:#fff}
button.btn:hover{background:var(--card-hover);color: #6B7280;border-color:#6B7280}
button.primary:hover{filter:brightness(0.95)}
button[disabled]{opacity:.35;cursor:not-allowed}
button.primary:disabled,
button.primary[disabled]{
  background:var(--brand);
  border-color:var(--brand);
  color:rgba(255,255,255,0.8);
}
button.btn:disabled,
button.btn[disabled]{
  background:var(--card);
  border-color:var(--border);
  color:var(--muted);
}
button.btn:focus-visible{outline:2px solid var(--brand);outline-offset:2px}

/* header inside list view */
.list-header{display:flex;align-items:center;gap:var(--space-3);justify-content:space-between;margin-top:var(--space-3)}
.list-name{font-weight:700;font-size:24px;line-height:1.2;cursor:pointer}

/* tasks */
.tasks{display:flex;flex-direction:column;gap:var(--space-3);margin-top:var(--space-4)}
.task{
  padding:var(--space-3);
  border-radius:var(--radius-sm);
  border:1px solid var(--border);
  display:flex;
  align-items:center;
  gap:var(--space-3);
  background:var(--card);
  box-shadow:var(--shadow-sm);
  transition:background var(--transition-fast), transform var(--transition-fast);
  touch-action:pan-y;
}
.task:hover{background:var(--card-hover)}
.task.swipe-anim{transition:transform .18s ease}
.task .text{flex:1;line-height:1.4}
.task.done .text{text-decoration:line-through;color:var(--muted)}

/* round checkbox */
.checkbox-round{
  width:28px;
  height:28px;
  border-radius:50%;
  border:2px solid var(--brand);
  display:inline-flex;
  align-items:center;
  justify-content:center;
  flex-shrink:0;
  background:transparent;
  color:var(--brand);
  transition:transform .14s ease, background var(--transition-fast), color var(--transition-fast);
}
.checkbox-round.checked{background:var(--brand);color:#fff}
.checkbox-round.pop{animation:pop .18s ease}
@keyframes pop{0%{transform:scale(1)}50%{transform:scale(.82) rotate(-8deg)}100%{transform:scale(1)}}

/* completed section header */
.completed-header{margin-top:var(--space-4);display:flex;align-items:center;gap:8px;cursor:pointer;color:var(--text);font-weight:600}
.completed-header .count{font-weight:700;margin-left:auto;color:var(--brand-700)}

/* floating add buttons */
.fab,
.fab-primary{
  position:fixed;
  right:calc(var(--gutter) + env(safe-area-inset-right, 0px));
  bottom:calc(var(--gutter) + env(safe-area-inset-bottom));
  width:64px;
  height:64px;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:32px;
  border:none;
  cursor:pointer;
  box-shadow:var(--shadow-md);
  background:var(--brand);
  color:#fff;
  transition:transform var(--transition-fast), box-shadow var(--transition-fast);
  touch-action:manipulation;
  z-index:30;
}
.fab .icon{display:inline-flex}
.fab:hover,
.fab-primary:hover{transform:translateY(-2px);box-shadow:0 16px 38px rgba(37,99,235,0.32)}
.fab:active,
.fab-primary:active{transform:scale(0.96)}
.fab:focus-visible,
.fab-primary:focus-visible{outline:2px solid #fff;outline-offset:2px;box-shadow:0 0 0 3px var(--brand)}
.fab{font-size:28px}

/* composer overlay (floating above content, attached to bottom/keyboard) */
.composer-backdrop{position:fixed;inset:0;background:rgba(17,24,39,0.45);display:none;align-items:flex-end;justify-content:center;z-index:70;padding:0 env(safe-area-inset-right) 0 env(safe-area-inset-left)}
.composer-backdrop.show{display:flex}
.composer-overlay{width:100%;max-width:520px;padding:12px 16px;border-top-left-radius:16px;border-top-right-radius:16px;background:var(--card);box-shadow:0 -8px 30px rgba(15,23,42,0.18)}
.composer-overlay .composer-row{display:flex;gap:var(--space-2);align-items:center}
.composer-overlay input{flex:1;padding:12px;border-radius:12px;border:1px solid var(--border);font-size:var(--fs-md);background:var(--bg);color:var(--text)}
.composer-overlay .send-btn{padding:10px 14px;border-radius:12px;border:none;background:var(--brand);color:#fff;font-weight:600;transition:transform var(--transition-fast)}
.composer-overlay .send-btn:disabled{opacity:.4}

/* task detail screen */
.task-detail{display:flex;flex-direction:column;gap:var(--space-4);padding:var(--space-3)}
.task-row{display:flex;align-items:center;gap:var(--space-3);padding:var(--space-3);border-radius:var(--radius-sm);border:1px solid var(--border);background:var(--card)}
.task-row .text{flex:1;min-height:20px}
.text[contenteditable]{outline:none}
.placeholder{color:var(--muted)}
#taskDetailText:empty::before{content:attr(data-placeholder);color:var(--muted)}

.task-detail-row{
  display:flex;
  align-items:center;
  gap:var(--space-3);
  border-radius:var(--radius-sm);
  background:var(--card);
  padding:var(--space-3);
  box-shadow:var(--shadow-sm);
  border:1px solid var(--border);
}

/* modal */
.modal-backdrop{position:fixed;inset:0;background:rgba(17,24,39,0.45);display:none;align-items:flex-start;justify-content:center;padding:20px;z-index:70}
.modal-backdrop.show{display:flex}
.modal{width:100%;max-width:520px;background:var(--card);padding:var(--space-4);border-radius:var(--radius-md);box-shadow:var(--shadow-md);margin-top:150px}
.modal h3{font-size:var(--fs-lg);margin-bottom:var(--space-3)}
.modal .modal-body{display:flex;flex-direction:column;gap:var(--space-3)}
.modal input{padding:12px;border-radius:12px;border:1px solid var(--border);font-size:var(--fs-md);background:var(--bg);color:var(--text)}
.modal .actions{display:flex;gap:var(--space-2);justify-content:flex-end;margin-top:var(--space-3)}
.confirm-modal .confirm-message{margin:var(--space-3) 0;color:var(--muted);line-height:1.5}

.toast-container{position:fixed;left:50%;bottom:var(--space-6);transform:translateX(-50%);display:flex;flex-direction:column;gap:var(--space-2);width:min(360px,90vw);z-index:120;pointer-events:none}
.toast{background:var(--card);color:var(--text);padding:12px 16px;border-radius:var(--radius-sm);box-shadow:var(--shadow-md);border:1px solid var(--border);opacity:0;transform:translateY(16px);transition:opacity var(--transition-fast),transform var(--transition-fast);pointer-events:auto;display:flex;align-items:center;gap:8px}
.toast.show{opacity:1;transform:translateY(0)}
.toast.error{border-color:#DC2626;color:#DC2626}
.toast.success{border-color:var(--brand);color:var(--brand)}

/* code modal */
.code-inputs{display:flex;align-items:center;justify-content:center;gap:var(--space-2)}
.code-inputs .code-input{width:44px;height:52px;text-align:center;font-size:22px;border:1px solid var(--border);border-radius:12px;background:var(--bg);color:var(--text)}
.code-gap{display:inline-block}

.share-backdrop{position:fixed;inset:0;background:rgba(17,24,39,0.45);display:none;align-items:flex-start;justify-content:center;padding:20px;z-index:70}
.share-backdrop.show{display:flex}
.share-dialog{width:100%;max-width:360px;background:var(--card);padding:var(--space-4);border-radius:var(--radius-md);display:flex;flex-direction:column;gap:var(--space-3);align-items:stretch;text-align:center;margin-top:150px;box-shadow:var(--shadow-md)}
.share-title{font-size:var(--fs-lg);font-weight:600;color:var(--text)}
.share-instructions{color:var(--muted);font-size:var(--fs-sm)}
.share-code-row{display:flex;align-items:center;justify-content:center;gap:var(--space-3)}
.share-code{font-weight:700;font-size:32px;letter-spacing:6px;color:var(--text)}
.copy-btn{border:1px solid var(--border);background:var(--bg);padding:10px;border-radius:12px;color:var(--text)}
.copy-btn svg{width:20px;height:20px}
.share-feedback{min-height:18px;font-size:13px;color:#047857}
.share-feedback.error{color:#B91C1C}
.share-close{align-self:center}

/* completed list container */
#completedList.tasks{margin-top:var(--space-3)}

/* Responsive tweaks */
@media (max-width:480px){
  body{padding:0;background:var(--bg)}
  .frame{border-radius:0;min-height:100vh;min-height:100dvh;box-shadow:none}
  header.appbar{padding:var(--space-3) var(--gutter)}
  .screen{padding:var(--space-3) var(--gutter) calc(70px + env(safe-area-inset-bottom))}
}

/* Estilos para sortable drag and drop */
/* arrastar em qualquer lugar do item */
.list-card,
.task { cursor: grab; }
.list-card:active,
.task:active { cursor: grabbing; }

.sortable-ghost {
  opacity: 0.5;
  background: var(--brand-50) !important;
}

.sortable-chosen {
  background: var(--brand-50) !important;
  box-shadow: var(--shadow-md);
}

.sortable-drag {
  opacity: 0.9;
  box-shadow: var(--shadow-md);
  z-index: 999;
}

@media (prefers-reduced-motion:reduce){
  *,*::before,*::after{transition-duration:0.001ms !important;animation-duration:0.001ms !important}
}
